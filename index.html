<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Save Our Villages - Stop Green Belt Development Between Birchanger and Stansted</title>
    <meta name="description" content="Join the campaign to stop City & Country's 480-home development on Green Belt land between Birchanger and Stansted Mountfitchet. Evidence-based opposition to inappropriate grey belt claims under NPPF Paragraph 155.">
    <meta name="keywords" content="Birchanger, Stansted Mountfitchet, Green Belt, grey belt, development, planning, NPPF, City and Country, Uttlesford">
    <meta property="og:title" content="Save Our Villages - Stop Green Belt Development">
    <meta property="og:description" content="Campaign against 480-home development on Green Belt between Birchanger and Stansted. Join our evidence-based opposition.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://saveourvillages.co.uk">
    <link rel="stylesheet" href="styles.css">

    <!-- Scroll Indicator Animation -->
    <style>
        @keyframes scrollDot {
            0% { top: 10px; opacity: 1; }
            50% { top: 30px; opacity: 0.3; }
            100% { top: 10px; opacity: 1; }
        }

        @keyframes flicker {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        /* Responsive grid for objection tracker and social sharing */
        @media (max-width: 768px) {
            .hero-grid {
                grid-template-columns: 1fr !important;
            }
        }

        /* Milestone tooltip styling */
        .milestone-label {
            position: relative;
        }
        .milestone-label::after {
            content: attr(title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.75rem;
            white-space: normal;
            width: 200px;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 100;
            pointer-events: none;
            line-height: 1.4;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .milestone-label:hover::after {
            opacity: 1;
            visibility: visible;
        }
        /* Milestone marker pulse animation for passed milestones */
        .milestone-marker.achieved {
            background: #4facfe !important;
            box-shadow: 0 0 8px rgba(79, 172, 254, 0.6);
        }

        /* Sticky CTA Bar */
        .sticky-cta-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #2c5f2d 0%, #4a7c59 100%);
            padding: 12px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            z-index: 1000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        .sticky-cta-bar.visible {
            transform: translateY(0);
        }
        .sticky-cta-bar .cta-text {
            color: white;
            font-size: 0.95rem;
            font-weight: 500;
            display: none;
        }
        .sticky-cta-bar .cta-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #ffd93d;
            color: #333;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        .sticky-cta-bar .cta-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        .sticky-cta-bar .close-btn {
            position: absolute;
            right: 15px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            line-height: 1;
        }
        .sticky-cta-bar .close-btn:hover {
            color: white;
        }
        @media (min-width: 600px) {
            .sticky-cta-bar .cta-text {
                display: block;
            }
        }
    </style>

    <!-- Chart.js for objection timeline -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- PostHog Analytics - Loaded immediately with opt-out by default -->
    <script>
        // Load PostHog immediately with opt-out by default for GDPR compliance
        !function(t,e){var o,n,p,r;e.__SV||(window.posthog && window.posthog.__loaded)||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.crossOrigin="anonymous",p.async=!0,p.src=s.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init fi Cr Or ci Tr Ir capture Mi calculateEventProperties Ar register register_once register_for_session unregister unregister_for_session Nr getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey displaySurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty jr Mr createPersonProfile Lr kr Ur opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing get_explicit_consent_status is_capturing clear_opt_in_out_capturing Fr debug M Dr getPageViewId captureTraceFeedback captureTraceMetric $r".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);

        // Initialize PostHog - TESTING: Removed opt-out to test if sequencing is the issue
        // Using Cloudflare reverse proxy to prevent ad-blocker blocking
        posthog.init('phc_bapf3RKKWohziv8014UqPW1ySks6p6NFHLbLZRPGJfz', {
            api_host: 'https://ph.saveourvillages.co.uk',
            defaults: '2025-05-24',
            person_profiles: 'identified_only',
            opt_out_capturing_by_default: false,  // TESTING: Changed to false
            persistence: 'localStorage',
            disable_toolbar: true,  // Hide PostHog toolbar from visitors
            disable_surveys: true,  // Disable survey popups
            disable_session_recording: true,  // Disable session recording UI
            advanced_disable_decide: true  // Disable feature flags/surveys from server
        });

        // Function to capture landing page data to PostHog (only after consent)
        function captureLandingPageToPostHog() {
            try {
                // Check if we have pending landing page data
                const pendingLandingData = sessionStorage.getItem('pendingLandingPageData');

                if (pendingLandingData && window.posthog) {
                    const landingData = JSON.parse(pendingLandingData);
                    console.log('Sending landing page data to PostHog:', landingData);

                    posthog.capture('landing_page_view', landingData);

                    // Clear the pending data after sending
                    sessionStorage.removeItem('pendingLandingPageData');
                    console.log('Landing page data sent and cleared');
                }
            } catch (e) {
                console.error('Error capturing landing page to PostHog:', e);
            }
        }

        // Check for existing consent on page load and restore opt-in state
        (function() {
            try {
                const consentData = localStorage.getItem('cookieConsent');
                if (consentData) {
                    const consent = JSON.parse(consentData);
                    if (consent.analytics === true) {
                        posthog.opt_in_capturing();
                        console.log('PostHog opt-in restored from saved consent');

                        // User has already consented - send any pending landing page data
                        setTimeout(function() {
                            captureLandingPageToPostHog();
                        }, 1000);
                    } else if (consent.analytics === false) {
                        posthog.opt_out_capturing();
                        console.log('PostHog opt-out maintained from saved consent');
                    }
                }
            } catch (e) {
                console.error('Error checking cookie consent:', e);
            }
        })();

        // TESTING: Capture landing page information immediately (no consent wait)
        window.addEventListener('load', function() {
            try {
                // First check if we have stored landing page data from a 404 redirect
                const stored404Data = sessionStorage.getItem('landingPageData');

                let landingPageData;

                if (stored404Data) {
                    // User came from a 404 page - use that data
                    const landingData = JSON.parse(stored404Data);
                    console.log('Found 404 landing page data:', landingData);

                    landingPageData = {
                        path: landingData.path,
                        referrer: landingData.referrer,
                        redirected_from_404: true,
                        actual_landing_url: landingData.url,
                        original_timestamp: landingData.timestamp,
                        current_timestamp: new Date().toISOString(),
                        // Override PostHog's automatic URL capture with the original landing URL
                        $current_url: landingData.url,
                        $pathname: landingData.path,
                        $referrer: landingData.referrer
                    };

                    // Clear the 404 data
                    sessionStorage.removeItem('landingPageData');
                } else {
                    // Normal landing page (no 404 redirect)
                    const urlParams = new URLSearchParams(window.location.search);
                    landingPageData = {
                        path: window.location.pathname,
                        referrer: document.referrer || 'direct',
                        utm_source: urlParams.get('utm_source') || null,
                        utm_medium: urlParams.get('utm_medium') || null,
                        utm_campaign: urlParams.get('utm_campaign') || null,
                        redirected_from_404: false,
                        timestamp: new Date().toISOString(),
                        // Set PostHog's automatic properties explicitly
                        $current_url: window.location.href,
                        $pathname: window.location.pathname
                    };
                }

                // TESTING: Send immediately to PostHog (no consent wait)
                console.log('TESTING: Sending landing page data immediately:', landingPageData);
                if (window.posthog) {
                    posthog.capture('landing_page_view', landingPageData);
                    console.log('Landing page data sent to PostHog immediately');
                }

            } catch (e) {
                console.error('Error capturing landing page:', e);
            }
        });
    </script>

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Save Our Villages",
        "description": "Campaign to protect Green Belt land between Birchanger and Stansted Mountfitchet from inappropriate development",
        "url": "https://saveourvillages.co.uk",
        "contactPoint": {
            "@type": "ContactPoint",
            "email": "admin@saveourvillages.co.uk",
            "telephone": "07368 501136",
            "contactType": "Campaign Information"
        },
        "sameAs": [
            "https://www.facebook.com/groups/2568902686636114"
        ],
        "areaServed": {
            "@type": "Place",
            "name": "Birchanger and Stansted Mountfitchet, Essex"
        }
    }
    </script>
</head>
<body>
    <!-- Header -->
    <header>
        <nav>
            <div class="logo">Save Our Villages</div>
            <button class="mobile-menu-toggle" onclick="toggleMenu()">‚ò∞</button>
            <ul class="nav-links" id="navLinks">
                <li><a href="index.html" class="active">Home</a></li>
                <li><a href="templates.html">Object</a></li>
                <li><a href="birchanger.html">Save Birchanger</a></li>
                <li><a href="stansted.html">Save Stansted</a></li>
                <li><a href="documentation.html">Documentation</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="#action">Take Action</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </nav>
    </header>

    <!-- Hero Section -->
    <div class="hero" style="background-image: linear-gradient(rgba(44, 95, 45, 0.7), rgba(74, 124, 89, 0.7)), url('images/Birchanger/Fields/IMG-20251011-WA0031.jpg');">
        <h1>Help Stop Green Belt Destruction</h1>
        <p class="subtitle">Our local countryside is under attack. Developer City & Country is pushing forward 480 homes (180 in Birchanger, 300 in Stansted) on protected Green Belt land.</p>
        <div style="text-align: center; margin-top: 1.5rem; max-width: 1100px; margin-left: auto; margin-right: auto;">

            <!-- Template button -->
            <a href="templates.html" style="display: inline-block; background: #ffd93d; color: #333; padding: 14px 28px; border-radius: 8px; text-decoration: none; font-weight: bold; font-size: 1.1rem; transition: all 0.3s ease; box-shadow: 0 3px 10px rgba(0,0,0,0.2); margin-bottom: 1.5rem;" onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 5px 15px rgba(0,0,0,0.3)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 3px 10px rgba(0,0,0,0.2)';">
                üìù Objection Walkthrough and Template ‚Üí
            </a>

            <!-- Motivational Text -->
            <p style="color: #fff; font-size: 1.1rem; margin: 0 auto 1.5rem; max-width: 700px; text-align: center; font-weight: 500; line-height: 1.6;">
                Developers are counting on silence. This meter shows how many of us have already said 'no'. Will you join us?
            </p>

            <!-- Objections Progress and Social Sharing -->
            <div class="hero-grid" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1.5rem; max-width: 1300px; margin: 0 auto 2rem;">

                <!-- Left: Progress Meter with Milestones -->
                <div style="background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px); border-radius: 15px; padding: 1rem 1.5rem; border: 2px solid rgba(255, 255, 255, 0.2);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; font-size: 0.95rem; font-weight: 600; color: white;">
                        <span>Objections Raised</span>
                        <span style="color: #ffd93d; font-size: 1.1rem;"><span id="hero-total">112</span></span>
                    </div>
                    <!-- Progress bar with milestone markers -->
                    <div style="position: relative; margin-bottom: 1.5rem;">
                        <div style="background: rgba(255, 255, 255, 0.2); border-radius: 20px; height: 30px; overflow: visible; box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2); position: relative;">
                            <div id="hero-progress-fill" style="height: 100%; background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%); border-radius: 20px; display: flex; align-items: center; justify-content: center; transition: width 1s ease; min-width: 50px; width: 5.6%; position: relative; z-index: 2;">
                                <span style="color: white; font-weight: bold; font-size: 0.8rem; text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);" id="hero-percentage">28%</span>
                            </div>
                            <!-- Milestone markers on the bar -->
                            <!-- 400 marker (20% of 2001) -->
                            <div class="milestone-marker" style="position: absolute; left: 20%; top: 0; bottom: 0; width: 3px; background: rgba(255, 217, 61, 0.8); z-index: 1;" title="400 - Minimum"></div>
                            <!-- 1000 marker (50% of 2001) -->
                            <div class="milestone-marker" style="position: absolute; left: 50%; top: 0; bottom: 0; width: 3px; background: rgba(255, 217, 61, 0.8); z-index: 1;" title="1000 - Community Majority"></div>
                        </div>
                        <!-- Milestone labels below the bar -->
                        <div style="position: relative; height: 45px; margin-top: 5px;">
                            <!-- 400 milestone -->
                            <div class="milestone-label" style="position: absolute; left: 20%; transform: translateX(-50%); text-align: center; cursor: help;"
                                 title="This number demonstrates clear, organised community opposition. Hitting this proves the objections aren't isolated or fringe; they're collective.">
                                <div style="font-size: 0.7rem; color: #ffd93d; font-weight: bold;">400</div>
                                <div style="font-size: 0.65rem; color: rgba(255,255,255,0.8); white-space: nowrap;">Minimum</div>
                            </div>
                            <!-- 1000 milestone -->
                            <div class="milestone-label" style="position: absolute; left: 50%; transform: translateX(-50%); text-align: center; cursor: help;"
                                 title="Over 10% of Stansted + Birchanger residents raising objections. This is a level planners cannot ignore.">
                                <div style="font-size: 0.7rem; color: #ffd93d; font-weight: bold;">1,000</div>
                                <div style="font-size: 0.65rem; color: rgba(255,255,255,0.8); white-space: nowrap;">Community Majority</div>
                            </div>
                            <!-- 2001 milestone (end) -->
                            <div class="milestone-label" style="position: absolute; right: 0; text-align: center; cursor: help;"
                                 title="The highest number of objections recorded locally. Achieving this sends a historic, unambiguous message to UDC.">
                                <div style="font-size: 0.7rem; color: #ffd93d; font-weight: bold;">2,001</div>
                                <div style="font-size: 0.65rem; color: rgba(255,255,255,0.8); white-space: nowrap;">Record Breaking</div>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center; font-size: 0.8rem; color: white;">
                        <span id="hero-progress-text" style="color: #ffd93d; font-weight: 600;">28% towards Minimum (400)</span>
                        <br><span id="hero-daily-rate" style="opacity: 0.8;">~16 per day</span>
                    </div>
                </div>

                <!-- Middle: Deadline Countdown -->
                <div style="background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px); border-radius: 15px; padding: 1rem 1.5rem; border: 2px solid rgba(255, 255, 255, 0.2);">
                    <div style="text-align: center; color: white;">
                        <div style="font-size: 0.95rem; font-weight: 600; margin-bottom: 0.75rem;">Objection Deadline</div>
                        <div style="font-size: 1.3rem; font-weight: bold; color: #ffd93d; margin-bottom: 0.5rem;">13th December</div>

                        <!-- Fuse Icon -->
                        <div style="margin: 0.75rem auto; width: 100%; max-width: 200px;">
                            <div style="display: flex; align-items: center; gap: 4px;">
                                <!-- Spark/Fire -->
                                <div style="font-size: 1.2rem; animation: flicker 1s infinite;">üî•</div>
                                <!-- Fuse Progress Bar -->
                                <div style="flex: 1; background: rgba(255, 255, 255, 0.2); border-radius: 10px; height: 12px; overflow: hidden; position: relative;">
                                    <div id="fuse-fill" style="height: 100%; background: linear-gradient(90deg, #ffd93d 0%, #ffcd00 100%); border-radius: 10px; transition: width 1s ease; width: 0%;"></div>
                                </div>
                                <!-- Bomb emoji at the end -->
                                <div style="font-size: 1.1rem;">üí£</div>
                            </div>
                        </div>

                        <div style="font-size: 0.85rem; opacity: 0.9; margin-top: 0.5rem;">
                            <span id="days-remaining">24 days</span> remaining
                        </div>
                    </div>
                </div>

                <!-- Right: Social Sharing Section -->
                <div style="background: rgba(0, 0, 0, 0.2); backdrop-filter: blur(10px); border-radius: 15px; padding: 1rem 1.5rem; border: 2px solid rgba(255, 255, 255, 0.2);">
                    <h3 style="color: white; font-size: 1rem; margin: 0 0 1rem 0; text-align: center; font-weight: 600; line-height: 1.3;">We're stronger together. We're stronger than any developer. Share this with friends and family:</h3>
                    <div style="display: flex; gap: 0.75rem; justify-content: center; flex-wrap: wrap;">
                            <!-- X (Twitter) Share Button -->
                            <a href="https://twitter.com/intent/tweet?text=Not%20only%20are%20our%20villages%20under%20threat%20from%20overdevelopment%2C%20but%20developers%20are%20trying%20to%20profit%20from%20turning%20greenbelt%20into%20housing%20estates.%20I%27ve%20just%20submitted%20an%20objection%20to%20City%20%26%20Country%27s%20plans%20for%20Birchanger%20and%20Stansted%20%E2%80%93%20it%20took%20less%20than%20a%20minute%20-%20but%20we%20need%20926%20more!%20Add%20your%20voice%3A%20saveourvillages.co.uk" id="share-x" target="_blank" title="Share on X" style="background: #000; color: white; width: 50px; height: 50px; border-radius: 50%; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.2);" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.3)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.2)';">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                            </a>

                            <!-- Facebook Share Button -->
                            <a href="#" id="share-facebook" title="Copy message and share on Facebook" style="background: #1877F2; color: white; width: 50px; height: 50px; border-radius: 50%; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.2);" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.3)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.2)';">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                            </a>

                            <!-- Reddit Share Button -->
                            <a href="https://reddit.com/submit?url=https%3A%2F%2Fsaveourvillages.co.uk&title=Not%20only%20are%20our%20villages%20under%20threat%20from%20overdevelopment%2C%20but%20developers%20are%20trying%20to%20profit%20from%20turning%20greenbelt%20into%20housing%20estates.%20I%27ve%20just%20submitted%20an%20objection%20to%20City%20%26%20Country%27s%20plans%20for%20Birchanger%20and%20Stansted%20%E2%80%93%20it%20took%20less%20than%20a%20minute%20-%20but%20we%20need%20926%20more!%20Add%20your%20voice%3A%20saveourvillages.co.uk" id="share-reddit" target="_blank" title="Share on Reddit" style="background: #FF4500; color: white; width: 50px; height: 50px; border-radius: 50%; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.2);" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.3)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.2)';">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
                            </a>

                            <!-- WhatsApp Share Button -->
                            <a href="https://api.whatsapp.com/send?text=Not%20only%20are%20our%20villages%20under%20threat%20from%20overdevelopment%2C%20but%20developers%20are%20trying%20to%20profit%20from%20turning%20greenbelt%20into%20housing%20estates.%20I%27ve%20just%20submitted%20an%20objection%20to%20City%20%26%20Country%27s%20plans%20for%20Birchanger%20and%20Stansted%20%E2%80%93%20it%20took%20less%20than%20a%20minute%20-%20but%20we%20need%20926%20more!%20Add%20your%20voice%3A%20saveourvillages.co.uk" id="share-whatsapp" target="_blank" title="Share on WhatsApp" style="background: #25D366; color: white; width: 50px; height: 50px; border-radius: 50%; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.2);" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.3)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.2)';">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                            </a>

                            <!-- Bluesky Share Button -->
                            <a href="https://bsky.app/intent/compose?text=Not%20only%20are%20our%20villages%20under%20threat%20from%20overdevelopment%2C%20but%20developers%20are%20trying%20to%20profit%20from%20turning%20greenbelt%20into%20housing%20estates.%20I%27ve%20just%20submitted%20an%20objection%20to%20City%20%26%20Country%27s%20plans%20for%20Birchanger%20and%20Stansted%20%E2%80%93%20it%20took%20less%20than%20a%20minute%20-%20but%20we%20need%20926%20more!%20Add%20your%20voice%3A%20saveourvillages.co.uk" id="share-bluesky" target="_blank" title="Share on Bluesky" style="background: #1185fe; color: white; width: 50px; height: 50px; border-radius: 50%; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.2);" onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.3)';" onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.2)';">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8Z"/></svg>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Objection Counters - Restyled -->
            <div style="display: flex; gap: 1rem; justify-content: center; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap;">
                <a href="https://publicaccess.uttlesford.gov.uk/online-applications/applicationDetails.do?keyVal=T5CHIEQNG2G00&activeTab=summary" target="_blank" style="background: rgba(255, 255, 255, 0.95); padding: 1rem 1.5rem; border-radius: 12px; min-width: 150px; text-align: center; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); transition: all 0.3s; border-top: 4px solid #4facfe; text-decoration: none; cursor: pointer;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0, 0, 0, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0, 0, 0, 0.2)';">
                    <div style="font-size: 2rem; font-weight: bold; line-height: 1; margin-bottom: 0.3rem; color: #4facfe;" id="birchanger-count-hero">38</div>
                    <div style="font-size: 0.85rem; color: #555; font-weight: 500;">Birchanger Objections</div>
                </a>

                <button onclick="openObjectionModal()" style="background: linear-gradient(135deg, #ffd93d 0%, #ffcd00 100%); color: #1a3a1b; border: none; padding: 1rem 1.5rem; border-radius: 12px; font-size: 0.95rem; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(255, 217, 61, 0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-2px) scale(1.05)'; this.style.boxShadow='0 6px 20px rgba(255, 217, 61, 0.6)';" onmouseout="this.style.transform='translateY(0) scale(1)'; this.style.boxShadow='0 4px 15px rgba(255, 217, 61, 0.4)';">
                    üìä Expand Details
                </button>

                <a href="https://publicaccess.uttlesford.gov.uk/online-applications/applicationDetails.do?activeTab=documents&keyVal=T5CHIWQNG2J00" target="_blank" style="background: rgba(255, 255, 255, 0.95); padding: 1rem 1.5rem; border-radius: 12px; min-width: 150px; text-align: center; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); transition: all 0.3s; border-top: 4px solid #fa709a; text-decoration: none; cursor: pointer;" onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(0, 0, 0, 0.3)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(0, 0, 0, 0.2)';">
                    <div style="font-size: 2rem; font-weight: bold; line-height: 1; margin-bottom: 0.3rem; color: #fa709a;" id="stansted-count-hero">36</div>
                    <div style="font-size: 0.85rem; color: #555; font-weight: 500;">Stansted Objections</div>
                </a>
            </div>

            <!-- Note about account requirement -->
            <p style="color: #fff; font-size: 0.9rem; margin: 0.5rem 0 1rem 0; opacity: 0.9;">
                Note: To object on the online portal you must create an account and then comment on each one
            </p>

            <!-- Or email option -->
            <p style="color: #fff; font-size: 1.1rem; margin: 1rem 0 0 0; font-weight: 500;">
                Or email your objection to <a href="mailto:Planning@uttlesford.gov.uk" style="color: #ffd93d; text-decoration: underline; font-weight: bold;">Planning@uttlesford.gov.uk</a>
            </p>
        </div>

        <!-- Scroll Indicator -->
        <div style="position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); text-align: center; opacity: 1;" id="scroll-indicator">
            <div style="width: 30px; height: 50px; border: 3px solid #2c5f2d; border-radius: 20px; position: relative; margin: 0 auto 10px; background: rgba(255, 255, 255, 0.9);">
                <div style="position: absolute; top: 10px; left: 50%; transform: translateX(-50%); width: 8px; height: 8px; background: #2c5f2d; border-radius: 50%; animation: scrollDot 2s infinite;"></div>
            </div>
            <span style="color: #2c5f2d; font-size: 0.9rem; font-weight: 700; text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8); background: rgba(255, 255, 255, 0.9); padding: 4px 12px; border-radius: 20px;">Learn More</span>
        </div>
        </div>
    </div>

    <!-- Alert Banner -->
    <div class="alert-banner">
        <h3>üö® PLANNING APPLICATIONS NOW SUBMITTED - OBJECT NOW!</h3>
        <p>City & Country has submitted TWO planning applications (split into Birchanger and Stansted). They claim this is "grey belt" under NPPF Paragraph 155 - but this land strongly serves Green Belt purposes. <strong>You have a limited time to object. Use our template and submit your objection today!</strong></p>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Overview Section -->
        <section id="learn-more" class="section">
            <h2>One Development. Two Communities at Risk.</h2>
            <p style="font-size: 1.2rem; margin-bottom: 2rem;">City & Country's proposed development of 480 homes (180 in Birchanger, 300 in Stansted) with claims of 50% "affordable" housing doesn't just threaten one community - it aims to obliterate the green buffer between Birchanger and Stansted Mountfitchet, merging them into continuous urban sprawl with Bishop's Stortford. The developer claims this meets NPPF Paragraph 155 "grey belt" criteria and the government's "Golden Rules" - but the evidence shows otherwise. Both parish councils and local groups have raised strong concerns about this devastating proposal.</p>

            <div class="stats">
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number">480</span>
                        <span class="stat-label">New Houses</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">~1,180</span>
                        <span class="stat-label">Daily Car Trips</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">~712</span>
                        <span class="stat-label">Resident Cars Added</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">1,520</span>
                        <span class="stat-label">Tonnes CO‚ÇÇ/year</span>
                    </div>
                </div>
            </div>

            <div class="impact-badges">
                <div class="impact-badge">
                    <span class="badge-number">~1,186</span>
                    <span class="badge-label">new residents</span>
                </div>
                <div class="impact-badge">
                    <span class="badge-number">0.19M</span>
                    <span class="badge-label">litres/day water demand</span>
                </div>
                <div class="impact-badge">
                    <span class="badge-number">72kg</span>
                    <span class="badge-label">PM‚ÇÇ.‚ÇÖ particles/year</span>
                </div>
                <div class="impact-badge">
                    <span class="badge-number">57dB</span>
                    <span class="badge-label">airport noise contour</span>
                </div>
            </div>
        </section>

        <!-- Shared Impact Section -->
        <section class="section">
            <h2>What Both Communities Stand to Lose</h2>

            <div class="grid">
                <div class="card">
                    <div class="card-icon"><img src="icons/Green-Belt-Logo-nobg.png" alt="Green Belt protection logo showing countryside landscape between urban settlements" style="width: 60px; height: 60px;"></div>
                    <h3>Green Belt Protection</h3>
                    <p>The land between our communities has been protected for decades. The new "grey belt" designation is being exploited to build on productive farmland that provides the vital green lung between settlements.</p>
                </div>

                <div class="card">
                    <div class="card-icon">üèòÔ∏è</div>
                    <h3>Distinct Identities</h3>
                    <p>Birchanger and Stansted have existed as separate communities for over 1,000 years. This development would merge them into one continuous urban area, erasing centuries of history.</p>
                </div>

                <div class="card">
                    <div class="card-icon">üöó</div>
                    <h3>Infrastructure Collapse</h3>
                    <p>Our roads are already congested, schools oversubscribed, and GP surgeries at capacity. Adding thousands more residents without infrastructure upgrades will create chaos.</p>
                </div>

                <div class="card">
                    <div class="card-icon">ü¶å</div>
                    <h3>Wildlife Corridors</h3>
                    <p>The fields between our communities provide vital wildlife corridors and habitats. Development would sever these connections, threatening local biodiversity.</p>
                </div>

                <div class="card">
                    <div class="card-icon">üíß</div>
                    <h3>Flood Risk</h3>
                    <p>Converting permeable farmland to concrete will increase surface water runoff, worsening flooding risks for existing residents in both communities.</p>
                </div>

                <div class="card">
                    <div class="card-icon">‚úàÔ∏è</div>
                    <h3>Airport Proximity</h3>
                    <p>Building thousands of homes near Stansted Airport ignores noise pollution and air quality concerns, while adding to already severe traffic problems.</p>
                </div>
            </div>
        </section>

        <!-- Our Stance -->
        <section class="section">
            <div style="background: linear-gradient(135deg, #2c5f2d 0%, #4a7c59 100%); color: white; padding: 3rem 2rem; border-radius: 15px; text-align: center; margin: 2rem 0;">
                <h2 style="color: white; margin-bottom: 1rem; font-size: 2.2rem;">We're not anti-housing.</h2>
                <p style="font-size: 1.3rem; font-weight: 500; margin-bottom: 1rem;">We're anti-irresponsible development that destroys Green Belt land.</p>
                <p style="font-size: 1.1rem; opacity: 0.9;">Protect our countryside. Protect our future.</p>
            </div>
        </section>

        <!-- The Developer's Strategy -->
        <section class="section">
            <h2>Understanding the Developer's Strategy</h2>
            <div class="card" style="background: #fff3cd; border-left: 5px solid #ffc107;">
                <h3 style="color: #856404;"><img src="icons/Green-Belt-Logo-nobg.png" alt="Green Belt designation icon representing protected countryside" style="width: 30px; height: 30px; vertical-align: middle; margin-right: 10px;">The "Grey Belt" Strategy Explained</h3>
                <p>City & Country claims this site qualifies as "grey belt" under NPPF Paragraph 155 and meets the government's "Golden Rules" for development. <strong>Our job is to prove they're wrong:</strong></p>
                <ul style="list-style: disc; padding-left: 2rem; margin-top: 1rem;">
                    <li><strong>This land is NOT grey belt</strong> because it strongly serves Green Belt purposes: prevents coalescence between Birchanger, Stansted and Bishop's Stortford; safeguards countryside character; preserves historic setting of medieval villages</li>
                    <li><strong>Para 155 sustainability test FAILS</strong> - site is car-dependent with poor public transport (bus route 308 hourly Mon-Sat only, last bus 6:30pm, no Sunday service), 2.1km from Stansted station with no continuous footway, fails DfT 800m walkability standard</li>
                    <li><strong>Development would undermine remaining Green Belt</strong> across Uttlesford by creating dangerous precedent and contradicting the spatial strategy in the emerging Local Plan</li>
                    <li><strong>No demonstrable unmet need in Uttlesford</strong> - the emerging Local Plan maintains Green Belt boundaries and has no allocation for this site</li>
                </ul>
                <p style="margin-top: 1rem;"><strong>Grey belt mythbuster:</strong> "Grey belt" is not automatic permission. ALL four Para 155 tests must pass. If even one fails, it's inappropriate development in Green Belt requiring very special circumstances.</p>

                <div style="background: #e8f5e9; padding: 1rem; margin-top: 1rem; border-radius: 5px;">
                    <h4 style="color: #2c5f2d; margin-bottom: 0.5rem;">Golden Rules Reality Check</h4>
                    <p style="margin: 0; font-size: 0.95rem;"><strong>City & Country claims:</strong> 50% affordable housing, school expansion land, >20% biodiversity net gain, net zero carbon homes.<br><br>
                    <strong>The reality:</strong> These "Golden Rules" must be viable, fully funded, legally secured via Section 106 agreements, and delivered BEFORE occupation - not vague promises. Where's the open-book viability assessment? Who pays for school buildings, not just land? How is 50% affordable housing economically deliverable? Are there binding triggers preventing occupation until infrastructure is built? <strong>Claims without enforceable legal commitments are meaningless.</strong></p>
                </div>
            </div>
        </section>

        <!-- Planning Timeline Section -->
        <section class="section">
            <h2>What Happens Next? The Planning Process Timeline</h2>
            <p style="font-size: 1.2rem; margin-bottom: 2rem; text-align: center;">Understanding the process helps us fight effectively at each stage</p>

            <div class="timeline-horizontal">
                <!-- Phase 1: Completed -->
                <div class="timeline-phase">
                    <div class="timeline-marker">1</div>
                    <div class="timeline-phase-content">
                        <div class="timeline-date">Nov 22 - Dec 2024</div>
                        <h4>FIRST CONSULTATION</h4>
                        <p class="timeline-status">Completed</p>
                        <ul>
                            <li>Initial 1,050-home proposal</li>
                            <li>Strong community opposition</li>
                            <li>Developer revises plans</li>
                        </ul>
                    </div>
                </div>

                <!-- Phase 2: Second Consultation -->
                <div class="timeline-phase">
                    <div class="timeline-marker">2</div>
                    <div class="timeline-phase-content">
                        <div class="timeline-date">Sep 5 - Oct 2, 2025</div>
                        <h4>SECOND CONSULTATION</h4>
                        <p class="timeline-status">Completed</p>
                        <ul>
                            <li>Revised 480-home proposal</li>
                            <li>111 residents attended exhibition</li>
                            <li>203 responses received</li>
                            <li>Closed October 2, 2025</li>
                        </ul>
                    </div>
                </div>

                <!-- Phase 3: Application -->
                <div class="timeline-phase active">
                    <div class="timeline-marker">3</div>
                    <div class="timeline-phase-content">
                        <div class="timeline-date">November 2025</div>
                        <h4>PLANNING APPLICATION</h4>
                        <p class="timeline-status">üî¥ NOW ACTIVE</p>
                        <ul>
                            <li><strong>TWO applications submitted (Birchanger & Stansted)</strong></li>
                            <li>Limited time consultation window</li>
                            <li>13-16 week decision period</li>
                            <li><strong>Object to BOTH applications now!</strong></li>
                        </ul>
                    </div>
                </div>

                <!-- Phase 4: Local Plan -->
                <div class="timeline-phase">
                    <div class="timeline-marker">4</div>
                    <div class="timeline-phase-content">
                        <div class="timeline-date">Early 2026</div>
                        <h4>LOCAL PLAN ADOPTION</h4>
                        <ul>
                            <li>Main modifications out Sept 2025</li>
                            <li>Keeps Green Belt boundaries intact</li>
                            <li>No allocation for this site</li>
                            <li>Creates policy headwind against development</li>
                        </ul>
                    </div>
                </div>

                <!-- Phase 5: Decision -->
                <div class="timeline-phase">
                    <div class="timeline-marker">5</div>
                    <div class="timeline-phase-content">
                        <div class="timeline-date">Mid 2026</div>
                        <h4>PLANNING DECISION</h4>
                        <p class="timeline-status">Committee Meeting</p>
                        <ul>
                            <li>Public can speak</li>
                            <li>Must prove para 155 tests or very special circumstances</li>
                            <li>Appeal possible if refused</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="timeline-key-message">
                <h3>üéØ THIS IS NOT A DONE DEAL!</h3>
                <p>No permission exists. The developer claims this meets NPPF Paragraph 155 "grey belt" criteria and the "Golden Rules" for development. Our job is to prove the land strongly serves Green Belt purposes, the site fails Para 155 sustainability tests, and the "Golden Rules" aren't deliverable or enforceable. With strong, evidence-based opposition, we can stop this.</p>
            </div>
        </section>

        <!-- Village Cards Section -->
        <section class="section">
            <h2 class="center">Choose A Community</h2>
            <p style="text-align: center; font-size: 1.1rem; margin-bottom: 3rem;">Each community faces unique threats. Select yours to learn more and take targeted action.</p>

            <div class="village-cards">
                <div class="village-card">
                    <div class="village-card-image" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5)), url('images/Birchanger/Church/IMG-20251007-WA0018_Church.jpg');">
                    </div>
                    <div class="village-card-content">
                        <h3>Save Birchanger</h3>
                        <p><strong>A historic village under siege.</strong> Birchanger's rural character, with its 12th-century church, ancient woodland, and tight-knit community of just 1,000 residents, faces complete transformation. This development would double our population overnight and destroy the green spaces that define our village identity.</p>
                        <a href="birchanger.html" class="btn btn-primary">Protect Birchanger ‚Üí</a>
                    </div>
                </div>

                <div class="village-card">
                    <div class="village-card-image" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5)), url('images/Stansted/Highstreet.jpg');">
                    </div>
                    <div class="village-card-content">
                        <h3>Save Stansted</h3>
                        <p><strong>A village's boundaries under threat.</strong> Stansted Mountfitchet's distinct identity as a historic village is at risk. The development would expand the village's footprint dramatically, overwhelming infrastructure already strained by airport traffic and removing the crucial green boundary with Bishop's Stortford.</p>
                        <a href="stansted.html" class="btn btn-primary">Defend Stansted ‚Üí</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Take Action Section -->
        <section id="action" class="section">
            <h2>United We Stand - Take Action Now</h2>
            <p style="font-size: 1.2rem; margin-bottom: 2rem;">Whether you live in Birchanger, Stansted, or nearby communities, we need your help to stop this development.</p>

            <div class="action-cards">
                <a href="mailto:Cllr.Ray.Gooding@essex.gov.uk" class="action-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <div class="icon">üìß</div>
                    <h3>Email Your Councillor</h3>
                    <p>Contact local representatives to express your opposition to the development.</p>
                </a>

                <a href="templates.html" class="action-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                    <div class="icon">üìù</div>
                    <h3>Object to the Plan</h3>
                    <p>Use our objection templates to submit your opposition to both planning applications - every objection counts.</p>
                </a>

                <a href="https://www.facebook.com/groups/2568902686636114" class="action-card">
                    <div class="icon">üë•</div>
                    <h3>Join the Campaign</h3>
                    <p>Connect with residents from both communities fighting to save our villages.</p>
                </a>

                <div class="action-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <div class="icon">üì¢</div>
                    <h3>Spread Awareness</h3>
                    <p>Share our campaign on social media and talk to neighbours about the threat.</p>
                </div>

                <div class="action-card" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                    <div class="icon">üèõÔ∏è</div>
                    <h3>Attend Meetings</h3>
                    <p>Join parish council meetings and public consultations to make your voice heard.</p>
                </div>
            </div>
        </section>

        <!-- Newsletter Signup -->
        <div class="newsletter">
            <h2>Stay Informed</h2>
            <p>Get updates on the campaign, action alerts, and important developments for both communities.</p>
            <form class="newsletter-form" action="https://formspree.io/f/xldpewza" method="POST">
                <input type="text" name="name" placeholder="Your name" required>
                <input type="email" name="email" placeholder="Your email address" required>
                <select name="interest" required style="padding: 0.8rem 1rem; border: none; border-radius: 5px; font-size: 1rem;">
                    <option value="Volunteer">I'd like to volunteer</option>
                    <option value="Help Objecting">I need help objecting</option>
                    <option value="More Information">Just keep me informed</option>
                </select>
                <button type="submit">Subscribe</button>
            </form>
            <p style="font-size: 0.9rem; margin-top: 1rem; opacity: 0.8;">We'll only use your email for campaign updates. View our <a href="#" id="newsletter-privacy-link" style="color: #ffd93d; text-decoration: underline;">Privacy Notice</a>.</p>
        </div>

        <!-- Why Para 155 Fails -->
        <section class="section">
            <h2>Why Para 155 Tests Fail</h2>
            <p style="font-size: 1.2rem; margin-bottom: 2rem; text-align: center;">This site cannot pass NPPF paragraph 155 requirements</p>

            <div class="evidence-tabs">
                <div class="evidence-tab active" data-target="not-grey-belt">
                    <h3>üåø Not Grey Belt</h3>
                    <p>Strong Green Belt contribution</p>
                </div>
                <div class="evidence-tab" data-target="not-sustainable">
                    <h3>üö∂ Not Sustainable</h3>
                    <p>Car-dependent location</p>
                </div>
                <div class="evidence-tab" data-target="undermines-belt">
                    <h3>üó∫Ô∏è Undermines Green Belt</h3>
                    <p>Plan-wide harm</p>
                </div>
            </div>

            <div class="evidence-content">
                <div id="not-grey-belt" class="evidence-panel active">
                    <h3>This Land is NOT Grey Belt</h3>
                    <div class="grid">
                        <div class="card">
                            <h4>üèòÔ∏è Prevents Coalescence</h4>
                            <p><strong>Current gap:</strong> Only 1.2km separates Birchanger and Stansted Mountfitchet centres. Development would create continuous urban sprawl to Bishop's Stortford.</p>
                        </div>
                        <div class="card">
                            <h4>üèõÔ∏è Historic Setting</h4>
                            <p><strong>Heritage assets:</strong> Birchanger's 12th-century church, historic village core, and Stansted's village character rely on countryside setting.</p>
                        </div>
                        <div class="card">
                            <h4>üåæ Countryside Character</h4>
                            <p><strong>Agricultural land:</strong> Active farmland with hedgerows, mature trees, and traditional field patterns. Clear contribution to countryside character.</p>
                        </div>
                    </div>
                </div>

                <div id="not-sustainable" class="evidence-panel">
                    <h3>Site Fails Sustainability Test</h3>
                    <div class="grid">
                        <div class="card">
                            <h4>üö∂ Walking Distances</h4>
                            <p><strong>Stansted Mountfitchet station:</strong> 2.1km (26 min walk) via B1383 with no continuous footway, 6% gradient, unlit sections. Far exceeds DfT recommended 800m walkable distance for daily trips.</p>
                        </div>
                        <div class="card">
                            <h4>üöå Public Transport</h4>
                            <p><strong>Bus service:</strong> Route 308 operates hourly Mon-Sat only, no Sunday service. Last bus 6:30pm. No evening connectivity to support sustainable commuting or social activities.</p>
                        </div>
                        <div class="card">
                            <h4>üõí Local Services</h4>
                            <p><strong>Nearest shops:</strong> 1.8km to village centre via narrow lanes. No daily convenience retail within 800m walkable threshold. Residents will be car-dependent for basic needs.</p>
                        </div>
                        <div class="card">
                            <h4>üöó Car Dependency</h4>
                            <p><strong>Transport reality:</strong> Site location forces reliance on private vehicles for work, shopping, healthcare, education. Cannot meet NPPF sustainability requirements for accessible locations.</p>
                        </div>
                        <div class="card">
                            <h4>üè• Essential Services</h4>
                            <p><strong>Healthcare and education:</strong> GP surgery 2.3km away with limited capacity, primary schools at capacity. New residents would strain existing services without sustainable access.</p>
                        </div>
                        <div class="card">
                            <h4>üåô Safety and Accessibility</h4>
                            <p><strong>Route conditions:</strong> Unlit country roads with no footways, dangerous for pedestrians and cyclists, especially children, elderly and disabled residents.</p>
                        </div>
                    </div>
                </div>

                <div id="undermines-belt" class="evidence-panel">
                    <h3>Development Undermines Plan-Wide Green Belt</h3>
                    <div class="grid">
                        <div class="card">
                            <h4>üó∫Ô∏è Strategic Green Belt Function</h4>
                            <p><strong>M11 corridor:</strong> Site forms part of continuous Green Belt preventing Cambridge-London urban sprawl. Development here would breach strategic containment policy and encourage linear sprawl.</p>
                        </div>
                        <div class="card">
                            <h4>üìã Local Plan Inconsistency</h4>
                            <p><strong>Settlement hierarchy:</strong> UDC's adopted spatial strategy directs growth to larger, more sustainable settlements. This proposal contradicts the plan-led system and undermines strategic planning.</p>
                        </div>
                        <div class="card">
                            <h4>‚öñÔ∏è Precedent Risk</h4>
                            <p><strong>Cumulative impact:</strong> Approval would establish dangerous precedent, encouraging similar speculative applications across Uttlesford's Green Belt boundary, fundamentally undermining protection.</p>
                        </div>
                        <div class="card">
                            <h4>üèûÔ∏è Landscape Integration</h4>
                            <p><strong>Regional context:</strong> Site contributes to wider Hertfordshire/Essex countryside character. Development would urbanize rural landscape and sever historic field patterns and ecological corridors.</p>
                        </div>
                        <div class="card">
                            <h4>üéØ Policy Conflict</h4>
                            <p><strong>Plan inconsistency:</strong> No allocation in emerging Local Plan, which maintains Green Belt boundaries. Approval would undermine evidence base and examination process.</p>
                        </div>
                        <div class="card">
                            <h4>‚ö° Infrastructure Impact</h4>
                            <p><strong>System stress:</strong> Development in unsustainable location increases pressure on infrastructure networks designed for existing settlements, creating systemic inefficiencies.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Methodology & Sources -->
        <section class="section">
            <div class="methodology-box">
                <h4>üî¨ Transparent Methodology</h4>
                <p><strong>Population:</strong> 480 homes √ó 2.47 persons/household (Census 2021) = 1,186 residents</p>
                <p><strong>Car trips:</strong> 1,186 residents √ó 363 car trips/person/year (NTS 2023) √∑ 365 = 1,180 daily trips</p>
                <p><strong>Car ownership:</strong> 1,186 residents √ó 0.6 cars/person (Uttlesford data) = 712 cars</p>
                <p><strong>CO‚ÇÇ emissions:</strong> Annual car miles √ó UK Govt conversion factors (2024) = 1,520 tonnes/year</p>
                <p><strong>Water demand:</strong> 1,186 residents √ó 160 litres/day = 190,000 litres/day (0.19 million litres)</p>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="section">
            <h2>Contact the Birchanger & Stansted Green Belt Preservation Group</h2>
            <div class="grid">
                <div class="card">
                    <h3>üìß Email</h3>
                    <p>admin@saveourvillages.co.uk</p>
                    <p style="margin-top: 1rem;">For questions about the campaign or how to get involved.</p>
                </div>

                <div class="card">
                    <h3>üìû Phone</h3>
                    <p>07368 501136</p>
                    <p style="margin-top: 1rem;">Call us to discuss concerns and find out how you can help.</p>
                </div>

                <div class="card">
                    <h3>üë• Facebook</h3>
                    <p><a href="https://www.facebook.com/groups/2568902686636114" style="color: #2c5f2d;">Birchanger and Stansted Greenbelt Preservation</a></p>
                    <p style="margin-top: 1rem;">Follow us for updates and join the community discussion.</p>
                </div>
            </div>

            <div style="background: #f8f9fa; padding: 2rem; border-radius: 10px; margin-top: 2rem; text-align: center;">
                <p style="font-style: italic; color: #6c757d; margin-bottom: 1rem;">The Birchanger and Stansted Green Belt Preservation Group is an independent resident-run campaign.</p>
                <p style="font-weight: bold; color: #2c5f2d;">Its aims are supported and endorsed by the Birchanger Residents Association and the Stansted Residents Association.</p>
            </div>
        </section>


    </div>

    <!-- Cookie Banner -->
    <div id="cookie-banner" class="cookie-banner">
        <div class="cookie-content">
            <p>We use essential cookies to make our site work, and would like to use analytics cookies to understand how visitors use our site. <a href="#privacy-notice" style="color: #4a7c59; text-decoration: underline;">View our Privacy Notice</a></p>
            <div style="display: flex; gap: 10px; margin-top: 10px;">
                <button onclick="rejectCookies()" class="cookie-reject-btn">Reject Analytics</button>
                <button onclick="acceptCookies()" class="cookie-accept-btn">Accept All</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>About the Campaign</h3>
                <p>A joint effort by residents of Birchanger and Stansted Mountfitchet to protect our communities from inappropriate development.</p>
            </div>

            <div class="footer-section">
                <h3>Quick Links</h3>
                <a href="birchanger.html">Save Birchanger</a>
                <a href="stansted.html">Save Stansted</a>
                <a href="blog.html">Campaign Blog</a>
                <a href="#action">Take Action</a>
            </div>

            <div class="footer-section">
                <h3>Campaign Partners</h3>
                <a href="https://www.birchanger.com/">Birchanger Parish Council</a>
                <a href="#">Stansted Mountfitchet PC</a>
                <a href="https://cpressex.org.uk/">CPRE Essex</a>
                <a href="#">Residents' Associations</a>
            </div>

            <div class="footer-section">
                <h3>Resources</h3>
                <a href="documentation.html">Planning Documents</a>
                <a href="templates.html">Templates</a>
                <a href="#">Campaign Materials</a>
                <a href="#">Media Coverage</a>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2025 Save Our Villages. Protecting Birchanger and Stansted Mountfitchet for future generations.</p>
            <p style="font-size: 0.85rem; margin-top: 0.5rem; opacity: 0.8;">Photography &copy; 2025 Dale Crowson. All rights reserved.</p>
            <p style="font-size: 0.85rem; margin-top: 0.5rem;">
                <a href="#" id="privacy-policy-link" style="color: #a7c4a7; text-decoration: underline;">Privacy Policy</a>
            </p>
        </div>
    </footer>

    <!-- Privacy Policy Modal -->
    <div id="privacy-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>Privacy Notice</h2>

            <p><strong>Data Controller:</strong> Save Birchanger Campaign Committee<br>
            Contact: admin@saveourvillages.co.uk | 07368 501136</p>

            <h3 style="margin-top: 1.5rem;">Newsletter Data Collection</h3>
            <p><strong>What we collect:</strong> Email addresses and names via our newsletter signup form.</p>
            <p><strong>Legal basis:</strong> Consent (GDPR Article 6(1)(a))</p>
            <p><strong>Purpose:</strong> To send campaign updates and action alerts.</p>
            <p><strong>Data processor:</strong> Formspree.io processes form submissions on our behalf.</p>
            <p><strong>Data use:</strong> Your email will only be used for campaign-related communications. We won't share your data with third parties for marketing.</p>
            <p><strong>Data retention:</strong> We retain email addresses until you unsubscribe or the campaign ends.</p>

            <h3 style="margin-top: 1.5rem;">Analytics Tracking (PostHog)</h3>
            <p><strong>What we collect:</strong> We use PostHog for analytics with the following privacy-first approach:</p>

            <h4 style="margin-top: 1rem; color: #2c5f2d;">Before You Make a Choice (Landing Page Only)</h4>
            <p>When you first visit our site, we collect minimal anonymous information about your landing page:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li>The page URL you landed on (e.g., /index.html, /birchanger.html)</li>
                <li>Referrer source (where you came from, e.g., Google, Facebook, or direct)</li>
                <li>Campaign tracking parameters (if you clicked a campaign link)</li>
                <li>Timestamp of your visit</li>
            </ul>
            <p><strong>Why:</strong> This helps us understand which pages bring visitors to our campaign and whether our outreach efforts are effective. This data is collected in opt-out mode (no cookies stored) and only sent to PostHog servers if you accept analytics tracking.</p>

            <h4 style="margin-top: 1rem; color: #2c5f2d;">After You Accept Analytics</h4>
            <p>If you consent to analytics cookies, we additionally collect:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li>All pages you visit on our website</li>
                <li>Device type and browser information</li>
                <li>Approximate location (country/city level)</li>
                <li>IP address (anonymized)</li>
                <li>How you navigate through our site</li>
            </ul>

            <p style="margin-top: 1rem;"><strong>Legal basis:</strong> Consent (GDPR Article 6(1)(a))</p>
            <p><strong>Purpose:</strong> To understand how visitors use our site and improve the campaign website.</p>
            <p><strong>Data processor:</strong> PostHog Inc. (EU-hosted servers at eu.i.posthog.com)</p>
            <p><strong>Your choice:</strong> You can accept or reject analytics cookies via our cookie banner. If you reject, the landing page data will not be sent to PostHog servers, and no future tracking will occur. Rejecting will not affect your ability to use the site.</p>
            <p><strong>PostHog Privacy Policy:</strong> <a href="https://posthog.com/privacy" target="_blank" style="color: #2c5f2d; text-decoration: underline;">https://posthog.com/privacy</a></p>

            <h3 style="margin-top: 1.5rem;">Your Rights Under UK GDPR</h3>
            <p>You have the right to:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li><strong>Access:</strong> Request a copy of your personal data</li>
                <li><strong>Rectification:</strong> Correct inaccurate data</li>
                <li><strong>Erasure:</strong> Request deletion of your data</li>
                <li><strong>Withdraw consent:</strong> Unsubscribe from emails or change cookie preferences at any time</li>
                <li><strong>Data portability:</strong> Receive your data in a portable format</li>
                <li><strong>Object:</strong> Object to processing of your data</li>
            </ul>

            <p style="margin-top: 1rem;"><strong>To exercise your rights or for privacy questions:</strong><br>
            Email: admin@saveourvillages.co.uk<br>
            Phone: 07368 501136</p>
        </div>
    </div>

    <!-- Objection Details Modal -->
    <div id="objection-modal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="modal-close" onclick="closeObjectionModal()">&times;</span>
            <h2 style="text-align: center; color: #2c5f2d;">Community Opposition Tracker</h2>
            <p style="text-align: center; font-size: 1.1rem; margin-bottom: 2rem; color: #666;">Objection letters submitted to Uttlesford District Council</p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 1.5rem; border-radius: 10px; text-align: center; color: white;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 0.5rem;" id="birchanger-count-modal">38</div>
                    <div style="font-size: 1rem; opacity: 0.9;">Birchanger (UTT/25/3011/OP)</div>
                </div>
                <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); padding: 1.5rem; border-radius: 10px; text-align: center; color: white;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 0.5rem;" id="stansted-count-modal">36</div>
                    <div style="font-size: 1rem; opacity: 0.9;">Stansted (UTT/25/3012/OP)</div>
                </div>
                <div style="background: linear-gradient(135deg, #2c5f2d 0%, #4a7c59 100%); padding: 1.5rem; border-radius: 10px; text-align: center; color: white;">
                    <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 0.5rem;" id="total-count-modal">74</div>
                    <div style="font-size: 1rem; opacity: 0.9;">Total Objections</div>
                </div>
            </div>

            <div style="margin-top: 2rem;">
                <h3 style="text-align: center; margin-bottom: 1rem; color: #2c5f2d;">Total Objections Progress</h3>
                <canvas id="cumulativeChart" style="margin-bottom: 3rem;"></canvas>
            </div>

            <div style="margin-top: 2rem;">
                <h3 style="text-align: center; margin-bottom: 1rem; color: #2c5f2d;">Daily Objection Letters</h3>
                <canvas id="dailyChart"></canvas>
            </div>

            <p style="text-align: center; margin-top: 1.5rem; font-size: 0.9rem; color: #666;">
                Data updated automatically every hour.<br>
                Last updated: <span id="last-updated">Loading...</span>
            </p>
        </div>
    </div>

    <script>
        // Mobile menu toggle
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }

        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Newsletter form - removed preventDefault to allow Formspree submission
        // Form now submits directly to Formspree

        // Evidence gallery tabs functionality
        document.querySelectorAll('.evidence-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs and panels
                document.querySelectorAll('.evidence-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.evidence-panel').forEach(p => p.classList.remove('active'));

                // Add active class to clicked tab
                this.classList.add('active');

                // Show corresponding panel
                const target = this.getAttribute('data-target');
                document.getElementById(target).classList.add('active');
            });
        });

        // Cookie banner functionality
        function showCookieBanner() {
            const consent = localStorage.getItem('cookieConsent');
            if (!consent) {
                document.getElementById('cookie-banner').classList.add('show');
            }
        }

        function acceptCookies() {
            const consent = {
                essential: true,
                analytics: true,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('cookieConsent', JSON.stringify(consent));
            document.getElementById('cookie-banner').classList.remove('show');

            // TESTING: PostHog is already capturing, just log the acceptance
            console.log('TESTING: User accepted cookies - PostHog already capturing');
        }

        function rejectCookies() {
            const consent = {
                essential: true,
                analytics: false,
                timestamp: new Date().toISOString()
            };
            localStorage.setItem('cookieConsent', JSON.stringify(consent));
            document.getElementById('cookie-banner').classList.remove('show');

            // Explicitly opt out of PostHog tracking
            posthog.opt_out_capturing();
            console.log('PostHog tracking disabled - no future events will be tracked');
        }

        // Show cookie banner on page load
        window.addEventListener('load', showCookieBanner);

        // Privacy Policy Modal functionality
        const privacyModal = document.getElementById('privacy-modal');
        const privacyPolicyLink = document.getElementById('privacy-policy-link');
        const newsletterPrivacyLink = document.getElementById('newsletter-privacy-link');
        const modalClose = document.querySelector('.modal-close');

        // Open modal when privacy policy link is clicked
        privacyPolicyLink.addEventListener('click', function(e) {
            e.preventDefault();
            privacyModal.style.display = 'block';
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        });

        // Open modal when newsletter privacy link is clicked
        newsletterPrivacyLink.addEventListener('click', function(e) {
            e.preventDefault();
            privacyModal.style.display = 'block';
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        });

        // Close modal when X is clicked
        modalClose.addEventListener('click', function() {
            privacyModal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Restore scrolling
        });

        // Close modal when clicking outside the modal content
        window.addEventListener('click', function(event) {
            if (event.target === privacyModal) {
                privacyModal.style.display = 'none';
                document.body.style.overflow = 'auto'; // Restore scrolling
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && privacyModal.style.display === 'block') {
                privacyModal.style.display = 'none';
                document.body.style.overflow = 'auto'; // Restore scrolling
            }
        });

        // Objection Data Storage
        let cumulativeChart = null;
        let dailyChart = null;
        let objectionChartData = null;

        // Objection Modal Functions
        function openObjectionModal() {
            document.getElementById('objection-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';

            // Create charts when modal opens (if data is loaded and charts don't exist)
            if (objectionChartData && !cumulativeChart && !dailyChart) {
                createObjectionCharts(objectionChartData);
            }
        }

        function closeObjectionModal() {
            document.getElementById('objection-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('objection-modal');
            if (event.target === modal) {
                closeObjectionModal();
            }
        });

        // Create Charts Function
        function createObjectionCharts(chartData) {
            // Calculate cumulative totals
            let cumulativeTotal = 0;
            const cumulativeData = chartData.birchangerData.map((birch, idx) => {
                cumulativeTotal += birch + chartData.stanstedData[idx];
                return cumulativeTotal;
            });

            // Target line data (1000 for all points)
            const targetData = chartData.labels.map(() => 1000);

            // 1. Create Cumulative Chart
            const cumulativeCtx = document.getElementById('cumulativeChart');
            if (cumulativeCtx) {
                if (cumulativeChart) {
                    cumulativeChart.destroy();
                }

                cumulativeChart = new Chart(cumulativeCtx, {
                    type: 'line',
                    data: {
                        labels: chartData.labels,
                        datasets: [
                            {
                                label: 'Total Objections',
                                data: cumulativeData,
                                borderColor: '#2c5f2d',
                                backgroundColor: 'rgba(44, 95, 45, 0.1)',
                                borderWidth: 4,
                                fill: true,
                                tension: 0.3,
                                pointRadius: 6,
                                pointHoverRadius: 8,
                                pointBackgroundColor: '#2c5f2d'
                            },
                            {
                                label: 'Target (1000)',
                                data: targetData,
                                borderColor: '#ff6b6b',
                                backgroundColor: 'transparent',
                                borderWidth: 2,
                                borderDash: [10, 5],
                                fill: false,
                                pointRadius: 0,
                                pointHoverRadius: 0
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 2.5,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    font: { size: 14 },
                                    padding: 15,
                                    usePointStyle: true
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                titleFont: { size: 14 },
                                bodyFont: { size: 13 },
                                callbacks: {
                                    label: function(context) {
                                        if (context.datasetIndex === 0) {
                                            const remaining = 1000 - context.parsed.y;
                                            return [
                                                'Total: ' + context.parsed.y + ' objections',
                                                'Remaining: ' + remaining + ' to target'
                                            ];
                                        }
                                        return 'Target: ' + context.parsed.y;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 1050,
                                ticks: {
                                    stepSize: 100,
                                    font: { size: 12 }
                                },
                                title: {
                                    display: true,
                                    text: 'Total Objections',
                                    font: { size: 14, weight: 'bold' }
                                }
                            },
                            x: {
                                ticks: {
                                    font: { size: 12 },
                                    maxRotation: 45,
                                    minRotation: 0
                                },
                                title: {
                                    display: true,
                                    text: 'Date',
                                    font: { size: 13 }
                                }
                            }
                        }
                    }
                });
            }

            // 2. Create Daily Bar Chart
            const dailyCtx = document.getElementById('dailyChart');
            if (dailyCtx) {
                if (dailyChart) {
                    dailyChart.destroy();
                }

                dailyChart = new Chart(dailyCtx, {
                    type: 'bar',
                    data: {
                        labels: chartData.labels,
                        datasets: [
                            {
                                label: 'Birchanger',
                                data: chartData.birchangerData,
                                backgroundColor: 'rgba(79, 172, 254, 0.8)',
                                borderColor: '#4facfe',
                                borderWidth: 2
                            },
                            {
                                label: 'Stansted',
                                data: chartData.stanstedData,
                                backgroundColor: 'rgba(250, 112, 154, 0.8)',
                                borderColor: '#fa709a',
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        aspectRatio: 2.5,
                        interaction: {
                            intersect: false,
                            mode: 'index'
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top',
                                labels: {
                                    font: { size: 14 },
                                    padding: 15,
                                    usePointStyle: true
                                }
                            },
                            tooltip: {
                                backgroundColor: 'rgba(0, 0, 0, 0.8)',
                                padding: 12,
                                titleFont: { size: 14 },
                                bodyFont: { size: 13 }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    stepSize: 2,
                                    font: { size: 12 }
                                },
                                title: {
                                    display: true,
                                    text: 'Objections per Day',
                                    font: { size: 14, weight: 'bold' }
                                }
                            },
                            x: {
                                ticks: {
                                    font: { size: 12 },
                                    maxRotation: 45,
                                    minRotation: 0
                                },
                                title: {
                                    display: true,
                                    text: 'Date',
                                    font: { size: 13 }
                                }
                            }
                        }
                    }
                });
            }
        }

        async function loadObjectionData() {
            try {
                const response = await fetch('/monitoring_data/latest.json');
                if (!response.ok) {
                    throw new Error('Failed to load objection data');
                }

                const data = await response.json();

                // Update total objection count
                const birchangerTotal = data.applications.birchanger?.total || 0;
                const stanstedTotal = data.applications.stansted?.total || 0;
                const totalObjections = birchangerTotal + stanstedTotal;

                // Update hero counters
                document.getElementById('birchanger-count-hero').textContent = birchangerTotal;
                document.getElementById('stansted-count-hero').textContent = stanstedTotal;

                // Milestone targets
                const milestones = [
                    { value: 400, label: 'Minimum', description: 'Clear community opposition' },
                    { value: 1000, label: 'Community Majority', description: '10% of residents' },
                    { value: 2001, label: 'Record Breaking', description: 'Historic message to UDC' }
                ];
                const maxTarget = 2001;

                // Find current and next milestone
                let currentMilestone = null;
                let nextMilestone = milestones[0];
                for (let i = 0; i < milestones.length; i++) {
                    if (totalObjections >= milestones[i].value) {
                        currentMilestone = milestones[i];
                        nextMilestone = milestones[i + 1] || milestones[i];
                    } else {
                        nextMilestone = milestones[i];
                        break;
                    }
                }

                // Calculate percentage towards next milestone
                const previousValue = currentMilestone ? currentMilestone.value : 0;
                const progressInCurrentSegment = totalObjections - previousValue;
                const segmentSize = nextMilestone.value - previousValue;
                const percentageTowardsNext = Math.min(100, Math.round((progressInCurrentSegment / segmentSize) * 100));

                // Calculate overall percentage for bar width (against 2001)
                const overallPercentage = ((totalObjections / maxTarget) * 100).toFixed(1);
                const dailyRate = Math.round(totalObjections / 8); // 8 days since Nov 12

                // Update display
                document.getElementById('hero-total').textContent = totalObjections;
                document.getElementById('hero-percentage').textContent = percentageTowardsNext + '%';
                document.getElementById('hero-progress-fill').style.width = overallPercentage + '%';
                document.getElementById('hero-daily-rate').textContent = '~' + dailyRate + ' per day';

                // Update progress text to show milestone progress
                const progressTextEl = document.getElementById('hero-progress-text');
                if (progressTextEl) {
                    if (totalObjections >= maxTarget) {
                        progressTextEl.innerHTML = 'üéâ <strong>RECORD BROKEN!</strong> ' + totalObjections + ' objections!';
                    } else {
                        const remaining = nextMilestone.value - totalObjections;
                        progressTextEl.innerHTML = percentageTowardsNext + '% towards ' + nextMilestone.label + ' (' + nextMilestone.value.toLocaleString() + ') - <strong>' + remaining + ' to go</strong>';
                    }
                }

                // Update modal counters
                document.getElementById('birchanger-count-modal').textContent = birchangerTotal;
                document.getElementById('stansted-count-modal').textContent = stanstedTotal;
                document.getElementById('total-count-modal').textContent = totalObjections;

                // Setup share buttons with dynamic message
                const shareRemaining = nextMilestone.value - totalObjections;
                const shareMessage = `Not only are our villages under threat from overdevelopment, but developers are trying to profit from turning greenbelt into housing estates. I've just submitted an objection to City & Country's plans for Birchanger and Stansted ‚Äì it took less than a minute - but we need ${shareRemaining} more to hit our ${nextMilestone.label} target! Add your voice: saveourvillages.co.uk`;
                const shareUrl = 'https://saveourvillages.co.uk';

                // Store share message globally for Facebook share function
                currentShareMessage = shareMessage;

                // Update share button hrefs
                document.getElementById('share-x').href = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent(shareMessage);
                // Facebook button uses onclick handler instead of href
                document.getElementById('share-facebook').onclick = shareFacebookWithCopy;
                document.getElementById('share-reddit').href = 'https://reddit.com/submit?url=' + encodeURIComponent(shareUrl) + '&title=' + encodeURIComponent(shareMessage);
                document.getElementById('share-whatsapp').href = 'https://api.whatsapp.com/send?text=' + encodeURIComponent(shareMessage);
                document.getElementById('share-bluesky').href = 'https://bsky.app/intent/compose?text=' + encodeURIComponent(shareMessage);

                // Update last updated timestamp
                const lastUpdated = new Date(data.last_updated);
                const formattedDate = lastUpdated.toLocaleString('en-GB', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                console.log('Last updated:', data.last_updated, '‚Üí', formattedDate);
                const lastUpdatedElement = document.getElementById('last-updated');
                if (lastUpdatedElement) {
                    lastUpdatedElement.textContent = formattedDate;
                    console.log('Last-updated element updated successfully');
                } else {
                    console.error('Last-updated element not found!');
                }

                // Prepare chart data (wrapped in try-catch to prevent errors from affecting other updates)
                try {
                    const birchangerByDate = data.applications.birchanger?.by_date || {};
                    const stanstedByDate = data.applications.stansted?.by_date || {};

                    // Get all unique dates and sort them
                    const allDates = new Set([
                        ...Object.keys(birchangerByDate),
                        ...Object.keys(stanstedByDate)
                    ]);
                    const sortedDates = Array.from(allDates).sort();

                    // Prepare datasets
                    const birchangerData = sortedDates.map(date => birchangerByDate[date] || 0);
                    const stanstedData = sortedDates.map(date => stanstedByDate[date] || 0);

                    // Format dates for display
                    const formattedDates = sortedDates.map(date => {
                        const d = new Date(date);
                        return d.toLocaleDateString('en-GB', { day: 'numeric', month: 'short' });
                    });

                    // Store chart data for later use (when modal opens)
                    objectionChartData = {
                        labels: formattedDates,
                        birchangerData: birchangerData,
                        stanstedData: stanstedData
                    };
                    console.log('Chart data prepared:', objectionChartData);
                } catch (chartError) {
                    console.error('Error preparing chart data:', chartError);
                    // Don't fail the whole function - counters and timestamp are already updated
                }

            } catch (error) {
                console.error('Error loading objection data:', error);
                // Set fallback values for hero
                document.getElementById('birchanger-count-hero').textContent = '38';
                document.getElementById('stansted-count-hero').textContent = '36';
                // Set fallback values for modal
                document.getElementById('birchanger-count-modal').textContent = '38';
                document.getElementById('stansted-count-modal').textContent = '36';
                document.getElementById('total-count-modal').textContent = '74';
                document.getElementById('last-updated').textContent = 'Data unavailable';
            }
        }

        // Calculate deadline countdown
        function updateDeadlineCountdown() {
            const deadlineDate = new Date('2025-12-13T23:59:59');
            const consultationStart = new Date('2025-11-12'); // First day was Wed 12 Nov 2025
            const today = new Date();

            // Calculate days remaining
            const timeRemaining = deadlineDate - today;
            const daysRemaining = Math.ceil(timeRemaining / (1000 * 60 * 60 * 24));

            // Update days remaining text
            const daysRemainingElement = document.getElementById('days-remaining');
            if (daysRemainingElement) {
                if (daysRemaining > 0) {
                    daysRemainingElement.textContent = daysRemaining + ' day' + (daysRemaining !== 1 ? 's' : '');
                } else if (daysRemaining === 0) {
                    daysRemainingElement.textContent = 'Last day!';
                } else {
                    daysRemainingElement.textContent = 'Deadline passed';
                }
            }

            // Calculate fuse progress (from Nov 12 to Dec 13 = 31 days total)
            const totalDays = Math.ceil((deadlineDate - consultationStart) / (1000 * 60 * 60 * 24));
            const elapsedDays = Math.max(0, Math.ceil((today - consultationStart) / (1000 * 60 * 60 * 24)));
            const fuseProgress = Math.min(100, (elapsedDays / totalDays) * 100);

            // Update fuse fill
            const fuseFillElement = document.getElementById('fuse-fill');
            if (fuseFillElement) {
                fuseFillElement.style.width = fuseProgress + '%';
            }
        }

        // Load objection data when page loads
        window.addEventListener('load', function() {
            loadObjectionData();
            updateDeadlineCountdown();
        });

        // Scroll indicator fade out
        window.addEventListener('scroll', function() {
            const scrollIndicator = document.getElementById('scroll-indicator');
            if (scrollIndicator) {
                if (window.scrollY > 100) {
                    scrollIndicator.style.opacity = '0';
                } else {
                    scrollIndicator.style.opacity = '1';
                }
            }
        });
    </script>

    <!-- Toast Notification for Copy Confirmation -->
    <div id="copy-toast" style="position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background: #2c5f2d; color: white; padding: 16px 24px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10000; opacity: 0; display: flex; align-items: center; gap: 10px; font-weight: 500; transition: opacity 0.3s ease-in-out; pointer-events: none;">
        <span>‚úì Message copied! Paste it into your Facebook post</span>
    </div>

    <script>
        // Global variable to store the current share message
        let currentShareMessage = '';

        // Function to handle Facebook share with clipboard copy
        function shareFacebookWithCopy(event) {
            event.preventDefault();

            // Copy message to clipboard
            navigator.clipboard.writeText(currentShareMessage).then(function() {
                // Show toast notification with fade-in
                const toast = document.getElementById('copy-toast');
                toast.style.opacity = '1';
                toast.style.pointerEvents = 'auto';

                // Hide toast after 4 seconds with fade-out
                setTimeout(function() {
                    toast.style.opacity = '0';
                    toast.style.pointerEvents = 'none';
                }, 4000);

                // Open Facebook after a brief delay
                setTimeout(function() {
                    window.open('https://www.facebook.com/', '_blank');
                }, 500);
            }).catch(function(err) {
                console.error('Failed to copy text: ', err);
                // Still open Facebook even if copy fails
                window.open('https://www.facebook.com/', '_blank');
            });
        }
    </script>

    <!-- Sticky CTA Bar -->
    <div class="sticky-cta-bar" id="sticky-cta">
        <span class="cta-text">Every objection matters - add yours today!</span>
        <a href="templates.html" class="cta-button">
            <span>üìù</span> Objection Walkthrough & Template
        </a>
        <button class="close-btn" onclick="closeStickyBar()" title="Close">&times;</button>
    </div>

    <script>
        // Sticky CTA Bar functionality
        (function() {
            const stickyBar = document.getElementById('sticky-cta');
            const hero = document.querySelector('.hero');
            let barClosed = false;

            function checkScroll() {
                if (barClosed) return;

                const heroBottom = hero.getBoundingClientRect().bottom;

                if (heroBottom < 0) {
                    stickyBar.classList.add('visible');
                } else {
                    stickyBar.classList.remove('visible');
                }
            }

            window.addEventListener('scroll', checkScroll, { passive: true });
            checkScroll(); // Check initial state
        })();

        function closeStickyBar() {
            const stickyBar = document.getElementById('sticky-cta');
            stickyBar.classList.remove('visible');
            stickyBar.style.display = 'none';
        }
    </script>
</body>
</html>